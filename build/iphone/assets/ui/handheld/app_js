function sendQr(e){"talleres"==win_name?network.postVisitWorkshop(e,function(e){0!=e&&Ti.UI.createAlertDialog({message:e.msg,ok:L("ok"),title:L("alert_title")}).show()}):"exposiciones"==win_name&&network.postVisitExposition(e,function(e){0!=e&&Ti.UI.createAlertDialog({message:e.msg,ok:L("ok"),title:L("alert_title")}).show()})}function validarQR(e){var i=e.split(":");return"emobile"==i[0]?i[1]:!1}var scanditsdk=require("com.mirasense.scanditsdk"),network=require("lib/network");("iphone"==Ti.Platform.osname||"ipad"==Ti.Platform.osname)&&(Ti.UI.iPhone.statusBarHidden=!0);var win_name=Ti.UI.currentWindow.win_name,picker,window=Ti.UI.createWindow({title:"Scandit SDK",navBarHidden:!0,fullscreen:!1,width:"100%",height:"90%",layout:"composite",zIndex:-1}),cancelBtn=Ti.UI.createButton({title:"Cancelar",width:"100%",height:"10%",bottom:"0dp",right:"0dp",backgroundColor:"#000"});cancelBtn.addEventListener("click",function(){alert("cancelar"),null!=picker&&(picker.stopScanning(),window.remove(picker)),window.close()});var openScanner=function(){picker=scanditsdk.createView({width:"100%",height:"100%",zIndex:0}),picker.init("XWkcvlLgEeOZgSuLYTIqxK5VJ0cL3LOltYWM/qYAWTM",0),picker.showToolBar(!0),picker.setSuccessCallback(function(e){var i=validarQR(e.barcode);0!=i&&sendQr(i)}),picker.setCancelCallback(function(){alert("cancelo"),closeScanner()}),window.add(cancelBtn),window.add(picker),window.addEventListener("open",function(){"iphone"==Ti.Platform.osname||"ipad"==Ti.Platform.osname?picker.setOrientation(Ti.UI.orientation):picker.setOrientation(window.orientation),picker.setSize(Ti.Platform.displayCaps.platformWidth,Ti.Platform.displayCaps.platformHeight),picker.startScanning()}),window.open()},closeScanner=function(){null!=picker&&(picker.stopScanning(),window.remove(picker)),window.close()};Ti.Gesture.addEventListener("orientationchange",function(e){window.orientationModes=[Ti.UI.PORTRAIT,Ti.UI.UPSIDE_PORTRAIT,Ti.UI.LANDSCAPE_LEFT,Ti.UI.LANDSCAPE_RIGHT],null!=picker&&(picker.setOrientation(e.orientation),picker.setSize(Ti.Platform.displayCaps.platformWidth,Ti.Platform.displayCaps.platformHeight))}),openScanner();