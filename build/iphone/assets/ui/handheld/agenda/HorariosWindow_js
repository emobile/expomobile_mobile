function HorariosWindow(e){function i(){Ti.Media.vibrate(),u.close()}function t(){var i=[];e.forEach(function(e){var t=e.split("/"),o=new Date(t[2],t[1]-1,t[0]),a=l[o.getDay()]+" "+o.getDate()+" - "+c[o.getMonth()],n=Ti.UI.createTableViewRow({id:e,title:a,isparent:!0,opened:!1,hasChild:!0,sub:[],font:{fontSize:"20dp"},color:"black"});h[""+a]=[],i.push(n)}),p.setData(i)}function o(){Ti.Media.vibrate(),u.close()}var a=require("lib/network"),n=require("tools"),r=n.isiOS7Plus(),d=require("ui/common/InfoWindow"),s=d.InfoWindow(),l=L("weekDays").split(","),c=L("months").split(","),u=Ti.UI.createWindow({tabBarHidden:!0,backgroundColor:"white",width:"100%",height:"100%",layout:"vertical",fullscreen:r,navBarHidden:!0}),p=Ti.UI.createTableView({width:"90%",height:Ti.Platform.displayCaps.platformHeight,style:Ti.UI.iPhone.TableViewStyle.GROUPED});scrollView_1=Ti.UI.createView({id:"scrollView_1",backgroundImage:"/images/background.png",height:"100%",width:"100%",layout:"vertical"});var w=require("templates"),g=w.getTopBar(L("diary"),"/images/horarios_blanco.png",i);scrollView_1.add(p),u.add(g),u.add(scrollView_1);var e,h=[],T=[];return t(),p.addEventListener("click",function(e){if(e.row.isparent)if(e.row.opened){for(var i=e.row.sub.length;i>0;i-=1)p.deleteRow(e.index+i);e.row.opened=!1}else if(0==h[e.rowData.title].length)a.getDataParam(a.SERVICES.DIARIES,e.row.id,function(i){var t=i;labelsEventos=[];for(var o=0;t.length>o;o++){var a={};a.id=""+t[o].id,a.left="15%",a.title=t[o].description+" - "+t[o].place+" - "+t[o].event_date.substring(11,16)+" - "+t[o].event_end_date.substring(11,16),a.font={fontSize:"14dp"},a.color="#424242",labelsEventos.push(a)}e.row.sub=labelsEventos;for(var n=0;labelsEventos.length>n;n++)p.insertRowAfter(e.index,labelsEventos[n],{animationStyle:Ti.UI.iPhone.RowAnimationStyle.RIGHT});h[e.rowData.title]=t,T[e.rowData.title]=labelsEventos,e.row.opened=!0});else{for(var i=0;h[e.rowData.title].length>i;i++)p.insertRowAfter(e.index,T[e.rowData.title][i],{animationStyle:Ti.UI.iPhone.RowAnimationStyle.RIGHT});e.row.opened=!0}else for(var t in h)h[t].forEach(function(i){if(e.rowData.id==i.id){var t="",o="";if(i.event_date.length>10){var a=i.event_date.substring(0,10),n=a.split("-");t=n[2]+"/"+c[n[1]-1]+"/"+n[0],o=i.event_date.substring(11,16)+" - "+i.event_end_date.substring(11,16)}var r={};r[L("name")]=i.description,r[L("start_date")]=t,r[L("event_type")]=i.event_type,r[L("place")]=i.place,r[L("hora")]=o,null!=i.observations&&(r[L("observations")]=i.observations),s.openView(r)}})}),u.addEventListener("android:back",function(){o()}),u}module.exports=HorariosWindow;