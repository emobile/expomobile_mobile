function QrReaderWindow(e,i){function t(e){Ti.UI.createAlertDialog({message:e,ok:L("ok"),title:L("alert_title")}).show()}function a(e){"talleres"==i?n.postVisitWorkshop(e,function(e){0!=e&&t(e.msg)}):"exposiciones"==i&&n.postVisitExposition(e,function(e){0!=e&&t(e.msg)})}function o(e){var i=e.split(":");return"emobile"==i[0]?i[1]:!1}var n=require("lib/network"),r=Ti.UI.createWindow({backgroundColor:"white"});if("android"==Ti.Platform.osname){var d=require("com.mwaysolutions.barcode");d.scan({success:function(e){if(e&&e.barcode){Ti.Media.vibrate();var i=o(e.barcode);0!=i?(a(i),r.close()):(t(L("qr_not_supported")),r.close())}else{Ti.Media.vibrate();var i=o(e.barcode);0!=i?a(i):(t(L("qr_not_supported")),r.close())}},error:function(){Ti.Media.vibrate(),t(L("errorqrcode")),r.close()},cancel:function(){r.close()}})}else{var l=require("tibar");l.scan({configure:{classType:"ZBarReaderController",sourceType:"Album",cameraMode:"Default",symbol:{"QR-Code":!0}},success:function(e){if(Ti.API.info("TiBar success callback!"),e&&e.barcode){var i=o(e.barcode);0!=i?(a(i),r.close()):(t(L("qr_not_supported")),r.close())}},cancel:function(){r.close()},error:function(){t(L("errorqrcode")),r.close()}})}return r.addEventListener("android:back",function(){r.close()}),r}module.exports=QrReaderWindow;