function QrReaderWindow(e,i){function t(e){"talleres"==i?a.postVisitWorkshop(e,function(e){0!=e&&Ti.UI.createAlertDialog({message:e.msg,ok:L("ok"),title:L("alert_title")}).show()}):"exposiciones"==i&&a.postVisitExposition(e,function(e){0!=e&&Ti.UI.createAlertDialog({message:e.msg,ok:L("ok"),title:L("alert_title")}).show()})}function o(e){var i=e.split(":");return"emobile"==i[0]?i[1]:!1}var a=require("lib/network"),n=Ti.UI.createWindow({backgroundColor:"white"});if("android"==Ti.Platform.osname){var r=require("com.mwaysolutions.barcode");r.scan({success:function(e){if(e&&e.barcode){Ti.Media.vibrate();var i=o(e.barcode);0!=i?(t(i),n.close()):(Ti.UI.createAlertDialog({message:L("qr_not_supported"),ok:L("ok"),title:L("alert_title")}).show(),n.close())}else{Ti.Media.vibrate();var i=o(e.barcode);0!=i?t(i):(Ti.UI.createAlertDialog({message:L("qr_not_supported"),ok:L("ok"),title:L("alert_title")}).show(),n.close())}},error:function(){Ti.Media.vibrate(),Ti.UI.createAlertDialog({message:L("errorqrcode"),ok:L("ok"),title:L("alert_title")}).show(),n.close()},cancel:function(){n.close()}})}else{var d=require("tibar");d.scan({configure:{classType:"ZBarReaderController",sourceType:"Album",cameraMode:"Default",symbol:{"QR-Code":!0}},success:function(e){if(Ti.API.info("TiBar success callback!"),e&&e.barcode){var i=o(e.barcode);0!=i?(t(i),n.close()):(Ti.UI.createAlertDialog({message:L("qr_not_supported"),ok:L("ok"),title:L("alert_title")}).show(),n.close())}},cancel:function(){n.close()},error:function(){alert(L("errorqrcode")),n.close()}})}return n.addEventListener("android:back",function(){n.close()}),n}module.exports=QrReaderWindow;