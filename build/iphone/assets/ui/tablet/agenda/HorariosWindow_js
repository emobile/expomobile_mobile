function HorariosWindow(e){function i(){var i=[];e.forEach(function(e){var t=e.split("/"),a=new Date(t[2],t[1]-1,t[0]),o=r[a.getDay()]+" "+a.getDate()+" - "+l[a.getMonth()],n=Ti.UI.createTableViewRow({id:e,title:o,isparent:!0,opened:!1,hasChild:!0,sub:[],font:{fontSize:"20dp"},color:"black"});s[""+o]=[],i.push(n)}),c.setData(i)}function t(){Ti.Media.vibrate(),d.close()}var a=require("lib/network"),o=require("ui/common/InfoWindow"),n=o.InfoWindow(),r=L("weekDays").split(","),l=L("months").split(","),d=Ti.UI.createWindow({tabBarHidden:!0,backgroundColor:"white",width:"100%",height:"100%",layout:"vertical",fullscreen:!1,navBarHidden:!0}),c=Ti.UI.createTableView({width:"90%",height:Ti.Platform.displayCaps.platformHeight,style:Ti.UI.iPhone.TableViewStyle.GROUPED});scrollView_1=Ti.UI.createView({id:"scrollView_1",backgroundImage:"/images/background.png",height:"100%",width:"100%",layout:"vertical"}),imageViewBar=Ti.UI.createView({id:"imageViewBar",backgroundColor:Ti.App.Properties.getString("viewcolor"),height:80,left:0,top:0,width:"100%"}),imageView=Ti.UI.createImageView({id:"imageView",image:"/images/horarios_blanco.png",width:60,height:60,top:10,left:10}),labelTitulo=Ti.UI.createLabel({id:"labelTitulo",height:"auto",text:L("diary"),font:{fontSize:"22dp"},color:"white",center:{x:"50%"},top:15}),labelSubTitulo=Ti.UI.createLabel({id:"labelSubtitulo",height:"auto",text:"Subtitulo",font:{fontSize:"18dp"},color:"white",center:{x:"50%"},top:40}),buttonClose=Ti.UI.createImageView({id:"buttonClose",image:"/images/close.png",width:30,height:30,top:10,right:10}),scrollView_1.add(c),imageViewBar.add(imageView),imageViewBar.add(buttonClose),imageViewBar.add(labelTitulo),d.add(imageViewBar),d.add(scrollView_1);var e,s=[],g=[];return i(),c.addEventListener("click",function(e){if(e.row.isparent)if(e.row.opened){for(var i=e.row.sub.length;i>0;i-=1)c.deleteRow(e.index+i);e.row.opened=!1}else if(0==s[e.rowData.title].length)a.getDataParam(a.SERVICES.DIARIES,e.row.id,function(i){var t=i;labelsEventos=[];for(var a=0;t.length>a;a++){var o={};o.id=""+t[a].id,o.left="15%",o.title=t[a].description+" - "+t[a].place+" - "+t[a].event_date.substring(11,16)+" - "+t[a].event_end_date.substring(11,16),o.font={fontSize:"14dp"},o.color="#424242",labelsEventos.push(o)}e.row.sub=labelsEventos;for(var n=0;labelsEventos.length>n;n++)c.insertRowAfter(e.index,labelsEventos[n],{animationStyle:Ti.UI.iPhone.RowAnimationStyle.RIGHT});s[e.rowData.title]=t,g[e.rowData.title]=labelsEventos,e.row.opened=!0});else{for(var i=0;s[e.rowData.title].length>i;i++)c.insertRowAfter(e.index,g[e.rowData.title][i],{animationStyle:Ti.UI.iPhone.RowAnimationStyle.RIGHT});e.row.opened=!0}else for(var t in s)s[t].forEach(function(i){if(e.rowData.id==i.id){var t="",a="";if(i.event_date.length>10){var o=i.event_date.substring(0,10),r=o.split("-");t=r[2]+"/"+l[r[1]-1]+"/"+r[0],a=i.event_date.substring(11,16)+" - "+i.event_end_date.substring(11,16)}var d={};d[L("name")]=i.description,d[L("start_date")]=t,d[L("event_type")]=i.event_type,d[L("place")]=i.place,d[L("hora")]=a,null!=i.observations&&(d[L("observations")]=i.observations),n.openView(d)}})}),buttonClose.addEventListener("click",function(){t()}),d.addEventListener("android:back",function(){t()}),d}module.exports=HorariosWindow;